!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Boa=e()}(this,function(){"use strict";var t={VERSION:"0.2.0",_bindings:[],_properties:{},_sources:{},_style:null,init:function(){var t=this;this._style=document.createElement("style"),document.head.appendChild(this._style),document.addEventListener("DOMContentLoaded",function(){new MutationObserver(function(e){e.forEach(t._handleMutation.bind(t))}).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeFilter:["class","style"]})})},_handleMutation:function(e){var r=e.target;this._bindings.forEach(function(e){t._matches(r,e.source.selector)&&e._apply(e,r)}.bind(this))},_matches:function(t,e){if(!t)return!1;var r=t.matches||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector;if(!r)throw new Error("Boa is unsupported on this browser.");return r.call(t,e)},findSources:function(e,r){var n,o=[];for(n in t._sources){var i=t._sources[n];i.property===r&&t._matches(document.querySelector(i.selector),e)&&o.push(i)}return o},setProperty:function(e,r,n){var o={value:function(){return n}};new t.Binding(o,e,r)},source:function(t,e){var r=t+"."+e;return this._sources.hasOwnProperty(r)||(this._sources[r]=new this.Source(t,e)),this._sources[r]},defineProperty:function(t,e){if(2!==arguments.length)throw new Error("Incorrect number of arguments to defineProperty");if(this._properties.hasOwnProperty(t))throw new Error("Property already exists");this._properties[t]=e},defineTransform:function(e,r){if("string"!=typeof e)throw new Error("name must be a string");if("function"!=typeof r)throw new Error("func must be a function");if(t.Source.prototype.hasOwnProperty(e))throw new Error("transform already exists");t.Source.prototype[e]=function(){var e=new t.Source(this.selector,this.property);return e._parentSource=this,e._transformArgs=arguments,e.value=function(){var t=[this._parentSource.value()],e=Array.prototype.concat.apply(t,this._transformArgs);return r.apply(this,e)},e}}};t.Source=function(t,e){this._bindings=[];var r=/((\w+):)?([\w-]+)/i,n=r.exec(e);if(!n)throw new Error("unable to parse property");this._custom=n[2],this.property=n[3],this.selector=t},t.Source.prototype._applyAllBindings=function(){this._bindings.forEach(function(t){t._apply()})},t.Source.prototype.bindTo=function(e,r){var n=new t.Binding(this,e,r);return t._bindings.push(n),this._bindings.push(n),n},t.Source.prototype.value=function(){var e=document.querySelector(this.selector);return this._custom?t._properties[this.property](e):window.getComputedStyle(e).getPropertyValue(this.property)},t.Binding=function(t,e,r){this.source=t,this.selector=e,this.property=r,this._apply()},t.Binding.prototype._apply=function(){var e=this.source.value();if(this.cssRule)this.cssRule.style[this.property]=e;else{var r=this.selector+"{"+this.property+":"+e+";}",n=t._style.sheet,o=n.insertRule(r,n.cssRules.length);this.cssRule=n.cssRules[o]}t.findSources(this.selector,this.property).forEach(function(t){t._applyAllBindings()})},t.defineProperty("clientLeft",function(t){return t.getBoundingClientRect().left}),t.defineProperty("clientTop",function(t){return t.getBoundingClientRect().top});var e=function(t){var e=parseFloat(t,10),r=t.replace(e.toString(),"");return{value:e,unit:r}},r=function(r){return function(n,o){return n=e(n),o instanceof t.Source?(o=e(o.value()),r(n.value,o.value)+n.unit):r(n.value,o)+n.unit}};return t.defineTransform("plus",r(function(t,e){return t+e})),t.defineTransform("minus",r(function(t,e){return t-e})),t.defineTransform("times",r(function(t,e){return t*e})),t.defineTransform("dividedBy",r(function(t,e){return t/e})),t.defineTransform("mod",r(function(t,e){return t%e})),t.init(),t});